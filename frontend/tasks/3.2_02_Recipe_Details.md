# Recipe Detail Screen Implementation - TODO

**Requirements**: Section 3.2, Step 2 from requirements.md

---

## 📋 Implementation Checklist

### ✅ Core Requirements
- [ ] **Navigation from Recipe List**
  - Integrate with RecipeCard component tap action
  - Pass recipe ID parameter through navigation
  - Handle navigation state and back button behavior
  - Maintain recipe list scroll position on return

- [ ] **Recipe Data Fetching**
  - API integration with `GET /recipes/:id`
  - Use existing apiService for real/mock data routing
  - Handle recipe ID parameter from navigation
  - Loading states during data fetch

- [ ] **Recipe Display Components**
  - Full-size recipe image with aspect ratio handling
  - Recipe title and description with proper typography
  - Category badge display
  - Favorite status indicator (heart icon)
  - Creation date and author information

- [ ] **Ingredients Section**
  - Organized list of ingredients with quantities
  - Clear formatting: "quantity unit ingredient_name"
  - Scrollable if ingredients list is long
  - Visual separation between ingredients
  - Support for different units (cups, tbsp, etc.)

- [ ] **Cooking Steps Section**
  - Numbered step-by-step instructions
  - Clear, readable typography for instructions
  - Step numbers with visual highlighting
  - Support for long instruction text
  - Easy scanning and following while cooking

- [ ] **Action Buttons**
  - Delete button - trigger confirmation dialog
  - Favorite toggle button (optional per requirements)
  - Share button (optional enhancement)
  - Proper button styling with orange theme

- [ ] **Delete Confirmation Dialog**
  - Modal dialog with warning message
  - "Cancel" and "Delete" action buttons
  - API call to `DELETE /recipes/:id` on confirm
  - Loading state during deletion
  - Navigation back to list on successful deletion

- [ ] **Favorite Toggle (Optional)**
  - Toggle favorite status with visual feedback
  - API calls: `POST /recipes/:id/favorite` and `DELETE /recipes/:id/favorite`
  - Optimistic UI updates with rollback on error
  - Sync with recipe list favorite status

### 🎨 Design Requirements

- [ ] **Dark Theme Implementation**
  - Consistent with existing orange theme (#FF6B35)
  - Dark background colors (#121212, #1E1E1E)
  - High contrast text colors (#FFFFFF, #B3B3B3)
  - Orange accents for interactive elements

- [ ] **Recipe Image Display**
  - Hero image at top with full width
  - 16:9 or 4:3 aspect ratio optimization
  - Loading placeholder and error fallback
  - High-quality image rendering with expo-image
  - Gradient overlay for better text readability

- [ ] **Content Layout**
  - Scrollable content with recipe image header
  - Sticky or floating action buttons
  - Clear section divisions (image, info, ingredients, steps)
  - Proper spacing and visual hierarchy
  - Card-based or section-based design

- [ ] **Typography Hierarchy**
  - Large title text for recipe name
  - Medium subtitle for description
  - Section headers for ingredients and steps
  - Body text for ingredient lists and instructions
  - Consistent font sizes and weights

- [ ] **Action Button Design**
  - Primary orange buttons for main actions
  - Secondary buttons with outline style
  - Delete button with red danger color
  - Proper touch targets ≥ 44px
  - Loading states with spinners

- [ ] **Responsive Layout**
  - Works on phones and tablets
  - Safe area handling for notched devices
  - Keyboard-aware when editing inline
  - Proper content padding and margins
  - Optimized for portrait and landscape modes

### 🔧 Technical Implementation

- [ ] **Dependencies**
  - React Native ScrollView for content scrolling
  - Modal or react-native-modal for confirmation dialog
  - Use existing components (Button, ConfirmationDialog, etc.)
  - expo-image for optimized image display

- [ ] **API Integration**
  - Use existing apiService.getRecipe(id) method
  - Support for recipe deletion via apiService.deleteRecipe(id)
  - Favorite toggle via apiService.toggleFavorite(id)
  - Handle loading, success, and error states
  - Error handling with user-friendly messages

- [ ] **Navigation Integration**
  - Receive recipe ID from navigation params from Recipe List tap
  - Navigate back to recipe list after deletion
  - Handle deep linking with recipe ID
  - Breadcrumb or back navigation
  - Update Recipe List navigation to include recipe detail route

- [ ] **State Management**
  - Local component state for recipe data
  - Loading and error state management
  - Favorite status sync with global state
  - Optimistic updates for better UX

- [ ] **Custom Hooks**
  - useRecipeDetail hook for data fetching
  - useConfirmDialog hook for delete confirmation
  - useFavoriteToggle hook (if implementing favorites)
  - Integration with existing useRecipes hook

- [ ] **Performance Optimization**
  - Image lazy loading and caching
  - Memoized components with React.memo
  - Efficient re-rendering on state changes
  - Memory management for large recipe data

- [ ] **Anonymous Mode Support**
  - Works seamlessly with mock data when anonymous
  - All display features available in demo mode
  - Delete actions disabled or demo-only in anonymous mode
  - Demo banner awareness

### 📁 File Structure

```
src/
├── components/
│   ├── RecipeDetailHeader/
│   │   ├── RecipeDetailHeader.tsx (new)
│   │   └── index.ts (new)
│   ├── IngredientsList/
│   │   ├── IngredientsList.tsx (new)
│   │   └── index.ts (new)
│   ├── CookingSteps/
│   │   ├── CookingSteps.tsx (new)
│   │   └── index.ts (new)
│   ├── RecipeActions/
│   │   ├── RecipeActions.tsx (new)
│   │   └── index.ts (new)
│   ├── ConfirmationDialog/
│   │   ├── ConfirmationDialog.tsx (existing)
│   │   └── index.ts (existing)
│   └── index.ts (updated)
├── screens/
│   ├── RecipeDetailScreen/
│   │   ├── RecipeDetailScreen.tsx (new)
│   │   └── index.ts (new)
│   └── index.ts (updated)
├── hooks/
│   ├── useRecipeDetail.ts (new)
│   ├── useConfirmDialog.ts (new)
│   └── index.ts (updated)
├── types/
│   ├── recipe.ts (updated if needed)
│   └── index.ts (updated)
```

### 🧪 Testing Requirements

- [ ] **Component Tests**
  - RecipeDetailScreen rendering with recipe data
  - IngredientsList display and formatting
  - CookingSteps numbering and content display
  - RecipeActions button functionality
  - ConfirmationDialog show/hide and actions

- [ ] **Integration Tests**
  - Recipe data loading from API/mock service
  - Navigation from Recipe List to Recipe Detail
  - Delete confirmation flow end-to-end
  - Favorite toggle functionality (if implemented)
  - Error handling for failed API calls
  - Back navigation to Recipe List with state preservation

- [ ] **User Interaction Tests**
  - Recipe image loading and error states
  - Scroll behavior with long content
  - Button press responses and navigation
  - Modal dialog interaction
  - Back navigation behavior

- [ ] **Accessibility Tests**
  - Screen reader compatibility for recipe content
  - Button accessibility labels and roles
  - Modal dialog focus management
  - Content reading order and hierarchy
  - Touch target sizes (≥44px)

### 🎯 Acceptance Criteria

**Given** a user navigates to a recipe detail screen  
**When** the recipe data loads  
**Then** display the full recipe image, title, description, ingredients, and cooking steps

**Given** a user taps on a recipe card in the Recipe List  
**When** they want to view recipe details  
**Then** navigate to the recipe detail screen with the selected recipe ID

**Given** a user taps the Delete button  
**When** they want to remove the recipe  
**Then** show a confirmation dialog with cancel and delete options

**Given** a user confirms recipe deletion  
**When** the delete API call succeeds  
**Then** navigate back to the recipe list and show success message

**Given** a user taps the Favorite button (if implemented)  
**When** they want to toggle favorite status  
**Then** update the favorite icon and sync with the recipe list

**Given** a user is viewing a long recipe  
**When** they scroll through the content  
**Then** smoothly scroll through image, ingredients, and steps sections

**Given** a user is in anonymous mode  
**When** they view a recipe detail  
**Then** show all recipe information with mock data and demo banner

**Given** a user experiences a network error  
**When** recipe data fails to load  
**Then** show error state with retry option and helpful messaging

**Given** a user has a slow network connection  
**When** the recipe is loading  
**Then** show loading indicators and progressive content loading

**Given** a user taps the back button  
**When** they want to return to the recipe list  
**Then** navigate back with proper state preservation

---

## 🚀 Implementation Priority

1. **Phase 1**: Navigation integration with Recipe List screen
2. **Phase 2**: Core recipe detail display with image, title, ingredients, and steps
3. **Phase 3**: Delete action button with confirmation dialog
4. **Phase 4**: Favorite toggle functionality (optional feature)
5. **Phase 5**: Performance optimization, error handling, and accessibility

---

## 📊 Performance Targets

- **Screen Load**: Recipe data display within 200ms of navigation
- **Image Loading**: Progressive loading with smooth placeholders
- **Scroll Performance**: Maintain 60fps during content scrolling
- **Action Response**: Button presses respond within 100ms
- **Memory Usage**: Efficient for high-resolution recipe images

---

## 🔗 Related Components

- **Existing**: Button, ConfirmationDialog, ErrorMessage, SuccessMessage, RecipeCard
- **Navigation**: Recipe List Screen (source and back navigation)
- **Services**: apiService, mockApiService
- **Theme**: Existing orange dark theme colors and typography

---

## 💡 Additional Features (Future Enhancements)

- **Recipe Scaling**: Adjust ingredient quantities for different servings
- **Timer Integration**: Start cooking timers for timed steps
- **Notes**: User-added notes or modifications to recipes
- **Print/Export**: Share or print recipe in formatted layout
- **Nutrition Info**: Display nutritional information if available
- **Related Recipes**: Show similar or recommended recipes

---

**Dependencies**: Recipe List Screen Implementation (3.2_01_Recipe_List.md)  
**Estimated Effort**: 4-6 hours  
**Status**: ✅ Completed  
**Assignee**: Claude Code  
**Created**: 2025-08-18

---

## 🔄 Recipe List Integration

### Navigation Setup
- [ ] **RecipeCard Navigation**
  - Update RecipeCard component with onPress handler
  - Pass recipe ID to navigation params
  - Use React Navigation for screen transition
  - Implement proper navigation typing

- [ ] **Navigation Stack**
  - Add RecipeDetail route to navigation stack
  - Configure screen options (title, back button)
  - Handle navigation state persistence
  - Implement smooth transitions

- [ ] **State Management**
  - Preserve Recipe List scroll position
  - Handle recipe data updates after deletion
  - Sync favorite status changes back to list
  - Manage navigation loading states

### Updated Acceptance Criteria

**Given** a user is viewing the Recipe List screen  
**When** they tap on any recipe card  
**Then** navigate to Recipe Detail screen with smooth transition and recipe ID parameter

**Given** a user deletes a recipe from Recipe Detail  
**When** the deletion is successful  
**Then** navigate back to Recipe List and remove the deleted recipe from the list

**Given** a user toggles favorite on Recipe Detail  
**When** the favorite status changes  
**Then** update the corresponding recipe card in Recipe List to reflect the new favorite status